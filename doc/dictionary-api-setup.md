# 词典验证 API 配置指南

## 概述

Sutom 游戏现在支持多种词典验证方式，以确保玩家输入的是有效的法语单词。系统会按优先级尝试不同的验证方式：

1. **Wiktionnaire API** - 免费的维基词典 API
2. **AI 验证** - 使用 OpenAI 等 AI 模型验证
3. **本地词典** - 基础法语词汇列表

## API 配置

### 1. Wiktionnaire API (免费)

**优势**：
- 完全免费
- 基于维基词典数据
- 支持法语

**配置**：
无需配置，系统会自动使用。

### 2. OpenAI API (付费)

**优势**：
- 高准确率
- 支持单词建议
- 可以理解上下文

**配置步骤**：
1. 访问 [OpenAI Platform](https://platform.openai.com/api-keys)
2. 注册并获取 API key
3. 在 `.env.local` 文件中添加：
   ```
   NEXT_PUBLIC_OPENAI_API_KEY=your_openai_api_key_here
   ```

### 3. 本地词典 (默认)

**优势**：
- 无需网络连接
- 响应速度快
- 完全免费

**限制**：
- 词汇量有限
- 仅包含基础法语单词

## 环境变量配置

在项目根目录创建 `.env.local` 文件：

```bash
# 词典验证 API 配置
# 注意：这些 API keys 都是可选的，系统会按优先级尝试不同的验证方式

# OpenAI API (用于 AI 验证) - 需要付费
NEXT_PUBLIC_OPENAI_API_KEY=your_openai_api_key_here
```

## 验证流程

1. **用户输入完整单词** 并点击确认
2. **系统开始验证**：
   - 显示"正在验证单词..."加载状态
   - 按优先级尝试不同的验证方式
3. **验证成功**：
   - 显示成功消息和验证来源
   - 继续进行游戏逻辑
4. **验证失败**：
   - 显示失败消息和具体错误
   - 如果有建议，显示修正建议
   - 要求用户重新输入

## 错误处理

- **网络错误**：自动尝试下一个验证方式
- **API 限制**：切换到备用验证方式
- **无效响应**：显示友好的错误消息

## 性能优化

- **缓存机制**：已验证的单词会被缓存
- **超时控制**：单个 API 调用不超过 5 秒
- **并发控制**：避免重复验证同一单词

## 测试建议

推荐使用以下法语单词进行测试：

**有效单词**：
- `cacophonie` (默认单词)
- `bonjour` (你好)
- `telephone` (电话)
- `ordinateur` (计算机)
- `clavier` (键盘)

**无效单词**：
- `abcdef` (随机字母)
- `hello` (英语单词)
- `123456` (数字)

## 故障排除

### 常见问题

1. **验证总是失败**
   - 检查网络连接
   - 确认 API key 是否正确
   - 查看浏览器控制台错误

2. **验证速度慢**
   - 检查网络延迟
   - 考虑使用本地词典

3. **API 配额用完**
   - 等待配额重置
   - 切换到其他验证方式

### 调试模式

在浏览器控制台中查看详细日志：
- 验证成功：`✅ 单词验证成功 (来源): 单词`
- 验证失败：错误详情和建议

## 未来扩展

- 支持更多语言
- 离线词典下载
- 用户自定义词典
- 词典统计和分析 