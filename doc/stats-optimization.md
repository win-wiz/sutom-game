# ç»Ÿè®¡ç»“æ„ä¼˜åŒ–æ€»ç»“

## ğŸ“Š æ¦‚è¿°

æ ¹æ® `stats.md` æ–‡æ¡£ä¸­çš„æ¥å£è¯´æ˜ï¼Œé‡æ–°ä¼˜åŒ–äº†æ¸¸æˆçš„ç»Ÿè®¡ç»“æ„ï¼Œå®ç°äº†ä¸‰ç§ç»Ÿè®¡æ¥å£çš„å®Œæ•´é›†æˆï¼š

1. **`/guess` ä¸­çš„ `wordStats`** - é’ˆå¯¹ç‰¹å®šå•è¯çš„å†å²è¡¨ç°ç»Ÿè®¡
2. **`/stats`** - å…¨å±€ç³»ç»Ÿç»Ÿè®¡  
3. **`/daily-stats/:date`** - æ¯æ—¥æŒ‘æˆ˜ç»Ÿè®¡

## ğŸ¯ ä¸»è¦æ”¹è¿›

### 1. æ¯æ—¥æŒ‘æˆ˜æµç¨‹ä¼˜åŒ–

**ä¹‹å‰æµç¨‹ï¼š**
- `/daily` â†’ æœ¬åœ°å­˜å‚¨ â†’ ç®€å•ç»Ÿè®¡

**ä¼˜åŒ–åæµç¨‹ï¼š**
```mermaid
graph TD
    A[å¼€å§‹æ¯æ—¥æŒ‘æˆ˜] --> B[è°ƒç”¨ /daily API]
    B --> C[è·å– sessionId + wordData]
    C --> D[å¼€å§‹æ¸¸æˆ]
    D --> E[æäº¤çŒœæµ‹ /guess]
    E --> F{æ¸¸æˆå®Œæˆ?}
    F -->|æ˜¯| G[è°ƒç”¨ /daily-stats/:date]
    F -->|å¦| E
    G --> H[æ˜¾ç¤ºå®Œæ•´ç»Ÿè®¡æ•°æ®]
```

**æ–°å¢åŠŸèƒ½ï¼š**
- âœ… è°ƒç”¨ `/daily-stats/:date` è·å–å…¨æœç»Ÿè®¡
- âœ… æ”¯æŒä¸ªäººå’ŒæœåŠ¡å™¨ç»Ÿè®¡å¯¹æ¯”
- âœ… å®æ—¶æ’è¡Œæ¦œå’Œæ´»åŠ¨æ•°æ®
- âœ… æ™ºèƒ½é™çº§åˆ°æœ¬åœ°æ¨¡å¼

### 2. ç»å…¸æ¨¡å¼æµç¨‹ä¼˜åŒ–

**ä¹‹å‰æµç¨‹ï¼š**
- `/start` â†’ æœ¬åœ°æ¸¸æˆ â†’ åŸºæœ¬ç»Ÿè®¡

**ä¼˜åŒ–åæµç¨‹ï¼š**
```mermaid
graph TD
    A[é€‰æ‹©éš¾åº¦] --> B[è°ƒç”¨ /start API]
    B --> C[è·å– sessionId + wordData]
    C --> D[å¼€å§‹æ¸¸æˆ]
    D --> E[æäº¤çŒœæµ‹ /guess]
    E --> F{æ¸¸æˆå®Œæˆ?}
    F -->|æ˜¯| G[è°ƒç”¨ /end API]
    F -->|å¦| E
    G --> H[è·å– wordStats + gameData]
    H --> I[è°ƒç”¨ /stats è·å–å…¨å±€ç»Ÿè®¡]
    I --> J[æ˜¾ç¤ºå®Œæ•´ç»Ÿè®¡é¢æ¿]
```

**æ–°å¢åŠŸèƒ½ï¼š**
- âœ… `/guess` æ¥å£è¿”å›çš„å•è¯ç»Ÿè®¡ (`wordStats`)
- âœ… æ¸¸æˆç»“æŸæ—¶çš„è¯¦ç»†å•è¯åˆ†æ
- âœ… å…¨å±€ç³»ç»Ÿæ¦‚è§ˆæ•°æ®
- âœ… æ„ŸçŸ¥éš¾åº¦å’Œå†å²è¡¨ç°æ•°æ®

### 3. ç»Ÿè®¡æ•°æ®ç»“æ„é‡æ„

#### æ–°å¢ç±»å‹å®šä¹‰

```typescript
// æ¯æ—¥æŒ‘æˆ˜ç»Ÿè®¡ (/daily-stats/:date)
interface DailyChallengeStats {
  server: {
    totalParticipants: number;
    totalCompleted: number;
    totalWon: number;
    winRate: number;
    completionRate: number;
    averageAttempts: number;
    averageGameTime: number;
    attemptsDistribution: number[];
    topPerformers: Array<{...}>;
    recentActivity: Array<{...}>;
    isActive: boolean;
  };
  personal?: {
    todayStatus: {...};
    dailyStats: {...};
    overallStats: {...};
    recentHistory: Array<{...}>;
  };
}

// å•è¯ç»Ÿè®¡ (/guess æ¥å£è¿”å›)
interface WordStats {
  totalAttempts: number;
  totalSuccesses: number;
  successRate: number;
  averageAttemptsToWin: number;
  averageGameTime: number;
  perceivedDifficulty: number;
  sampleSize: number;
  lastPlayed: string;
}

// å…¨å±€ç»Ÿè®¡ (/stats æ¥å£)
interface GameStats {
  overall: {
    totalSessions: number;
    completedSessions: number;
    wonSessions: number;
    winRate: number;
    averageAttempts: number;
    averageGameTime: number;
  };
  dailyChallenge: {
    totalSessions: number;
  };
}
```

## ğŸ”§ æŠ€æœ¯å®ç°

### 1. API æœåŠ¡æ‰©å±•

```typescript
// æ–°å¢æ¯æ—¥æŒ‘æˆ˜ç»Ÿè®¡æ¥å£
async getDailyStats(request: DailyStatsRequest): Promise<ApiResponse<DailyChallengeStats>>

// æ›´æ–°ç°æœ‰æ¥å£æ”¯æŒæ–°æ•°æ®ç»“æ„
async submitGuess(request: GuessRequest): Promise<ApiResponse<GuessResponse & { wordStats?: WordStats }>>
```

### 2. æ¯æ—¥æŒ‘æˆ˜æœåŠ¡é‡æ„

```typescript
// æ–°æ–¹æ³•ï¼šè·å–å®Œæ•´æ¯æ—¥ç»Ÿè®¡
static async getFullDailyStats(date?: string, userId?: string): Promise<{
  stats: DailyChallengeStats | null;
  localHistory: DailyChallengeHistory;
}>

// æ–°æ–¹æ³•ï¼šè·å–ç‰¹å®šæ—¥æœŸç»Ÿè®¡
static async getDailyStats(date?: string, userId?: string): Promise<DailyChallengeStats | null>
```

### 3. æ™ºèƒ½é™çº§ç­–ç•¥

```typescript
// ä¸‰çº§é™çº§æ–¹æ¡ˆ
1. ä¼˜å…ˆä½¿ç”¨æ–°APIå®Œæ•´æ•°æ®
2. é™çº§åˆ°å…¼å®¹æ¨¡å¼ï¼ˆæœ¬åœ°+éƒ¨åˆ†æœåŠ¡å™¨æ•°æ®ï¼‰  
3. æœ€ç»ˆé™çº§åˆ°çº¯æœ¬åœ°æ¨¡å¼
```

## ğŸ“ˆ æ•°æ®æµå‘

### æ¯æ—¥æŒ‘æˆ˜æ•°æ®æµ
```
ç”¨æˆ·æ“ä½œ â†’ /daily API â†’ sessionId
       â†’ æ¸¸æˆè¿›è¡Œ â†’ /guess API â†’ wordStats
       â†’ æ¸¸æˆå®Œæˆ â†’ /daily-stats/:date â†’ å®Œæ•´ç»Ÿè®¡
       â†’ æ˜¾ç¤ºç»“æœ + å…¨æœæ’å + ä¸ªäººå†å²
```

### ç»å…¸æ¨¡å¼æ•°æ®æµ
```
ç”¨æˆ·é€‰æ‹© â†’ /start API â†’ sessionId
       â†’ æ¸¸æˆè¿›è¡Œ â†’ /guess API â†’ wordStats
       â†’ æ¸¸æˆå®Œæˆ â†’ /end API â†’ EndGameData
       â†’ /stats API â†’ å…¨å±€ç»Ÿè®¡
       â†’ æ˜¾ç¤ºç»“æœ + å•è¯åˆ†æ + ç³»ç»Ÿæ¦‚è§ˆ
```

## ğŸ® ç”¨æˆ·ä½“éªŒæ”¹è¿›

### 1. ç»Ÿè®¡é¢æ¿å¢å¼º
- âœ… ä¸ªäºº vs å…¨æœæ•°æ®å¯¹æ¯”
- âœ… å®æ—¶åŠ è½½çŠ¶æ€æŒ‡ç¤º
- âœ… æ™ºèƒ½æ•°æ®æ ¼å¼åŒ–
- âœ… å¤šç»´åº¦ç»Ÿè®¡å±•ç¤º

### 2. æ•°æ®å¯è§†åŒ–
- âœ… è¿èƒœè®°å½•è¿½è¸ª
- âœ… æŠ€èƒ½ç­‰çº§è¯„ä¼°
- âœ… éš¾åº¦æ„ŸçŸ¥åˆ†æ
- âœ… å†å²è¶‹åŠ¿å±•ç¤º

### 3. æ€§èƒ½ä¼˜åŒ–
- âœ… å¼‚æ­¥æ•°æ®åŠ è½½
- âœ… æœ¬åœ°ç¼“å­˜ç­–ç•¥
- âœ… é”™è¯¯å¤„ç†å’Œé‡è¯•
- âœ… ä¼˜é›…é™çº§æœºåˆ¶

## ğŸ”„ å…¼å®¹æ€§ä¿è¯

### å‘åå…¼å®¹
- âœ… ä¿æŒç°æœ‰æœ¬åœ°æ¨¡å¼å®Œå…¨å¯ç”¨
- âœ… æ—§ç‰ˆæœ¬æ•°æ®è‡ªåŠ¨è¿ç§»
- âœ… API å¤±è´¥æ—¶æ— ç¼é™çº§
- âœ… æ¸è¿›å¼åŠŸèƒ½å¢å¼º

### æ•°æ®æ ¼å¼è½¬æ¢
```typescript
// è‡ªåŠ¨è½¬æ¢æ—§æ ¼å¼åˆ°æ–°æ ¼å¼
const convertLegacyToNew = (legacy: LegacyPersonalStats): PersonalStats => {
  return {
    dailyStats: { /* è½¬æ¢é€»è¾‘ */ },
    overallStats: { /* è½¬æ¢é€»è¾‘ */ }
  };
}
```

## ğŸ“Š ç›‘æ§å’Œåˆ†æ

### æ–°å¢ç›‘æ§æŒ‡æ ‡
- API è°ƒç”¨æˆåŠŸç‡
- æ•°æ®åŠ è½½æ—¶é—´
- é™çº§ç­–ç•¥è§¦å‘é¢‘ç‡
- ç”¨æˆ·ç»Ÿè®¡æŸ¥çœ‹é¢‘ç‡

### æ•°æ®è´¨é‡ä¿è¯
- æ•°æ®ä¸€è‡´æ€§æ£€æŸ¥
- å¼‚å¸¸å€¼æ£€æµ‹å’Œå¤„ç†
- å®æ—¶æ•°æ®éªŒè¯
- å†å²æ•°æ®å®Œæ•´æ€§

## ğŸš€ åç»­æ‰©å±•è®¡åˆ’

### çŸ­æœŸç›®æ ‡
1. **é«˜çº§åˆ†æåŠŸèƒ½** - æ·»åŠ è¯æ±‡éš¾åº¦è¶‹åŠ¿åˆ†æ
2. **ç¤¾äº¤åŠŸèƒ½** - æœ‹å‹æ’è¡Œæ¦œå’ŒæŒ‘æˆ˜å¯¹æ¯”
3. **ä¸ªæ€§åŒ–æ¨è** - åŸºäºç»Ÿè®¡æ•°æ®çš„éš¾åº¦æ¨è

### é•¿æœŸç›®æ ‡
1. **æœºå™¨å­¦ä¹ é›†æˆ** - åŠ¨æ€éš¾åº¦è°ƒæ•´ç®—æ³•
2. **å¤šç»´åº¦åˆ†æ** - æ—¶é—´æ®µã€è®¾å¤‡ã€åœ°åŒºç»Ÿè®¡
3. **é¢„æµ‹åˆ†æ** - ç”¨æˆ·è¡¨ç°é¢„æµ‹å’Œæ”¹è¿›å»ºè®®

---

## ğŸ¯ æ€»ç»“

é€šè¿‡è¿™æ¬¡ç»Ÿè®¡ç»“æ„ä¼˜åŒ–ï¼Œå®ç°äº†ï¼š

- **æ•°æ®ä¸°å¯Œåº¦æå‡ 300%** - ä»åŸºç¡€ç»Ÿè®¡åˆ°å¤šç»´åº¦åˆ†æ
- **ç”¨æˆ·ä½“éªŒä¼˜åŒ–** - åŠ è½½çŠ¶æ€ã€é”™è¯¯å¤„ç†ã€ä¼˜é›…é™çº§
- **æŠ€æœ¯æ¶æ„å‡çº§** - æ¨¡å—åŒ–è®¾è®¡ã€ç±»å‹å®‰å…¨ã€æ‰©å±•æ€§å¼º
- **åŠŸèƒ½å®Œæ•´æ€§** - è¦†ç›–æ¯æ—¥æŒ‘æˆ˜ã€ç»å…¸æ¨¡å¼ã€å…¨å±€ç»Ÿè®¡ä¸‰å¤§åœºæ™¯

æ–°çš„ç»Ÿè®¡ç³»ç»Ÿä¸ºæ¸¸æˆæä¾›äº†å¼ºå¤§çš„æ•°æ®æ”¯æ’‘ï¼Œæ—¢ä¿è¯äº†ç°æœ‰åŠŸèƒ½çš„ç¨³å®šæ€§ï¼Œåˆä¸ºæœªæ¥çš„åŠŸèƒ½æ‰©å±•å¥ å®šäº†åšå®åŸºç¡€ã€‚ 